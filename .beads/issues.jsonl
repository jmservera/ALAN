{"id":"ALAN-sbd","title":"Add npx MCP server support to ALAN.Agent","description":"Epic: Enable ALAN.Agent to spawn and manage MCP servers via npx commands (stdio transport). Currently only HTTP transport is implemented.\n\n## Current State\n- McpConfigurationService only implements HTTP transport\n- YAML config model already supports command/args/env for npx servers\n- Documentation shows npx examples but they don't work yet\n\n## Goal\nAdd full stdio transport support to spawn npx-based MCP servers\n\n## Success Criteria\n- [ ] Agent can spawn npx MCP processes\n- [ ] Environment variables are properly passed\n- [ ] Process lifecycle is managed (start/stop/restart)\n- [ ] At least 2 popular npx MCP servers configured and tested","status":"open","priority":1,"issue_type":"epic","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:29:00.861550524+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:29:00.861550524+01:00","labels":["feature","mcp"]}
{"id":"ALAN-sbd.1","title":"Implement stdio transport in McpConfigurationService","description":"Add stdio transport support to McpConfigurationService to spawn MCP servers via npx/command.\n\n## Technical Details\n- Use ModelContextProtocol.Client StdioClientTransport\n- Spawn process with configured command and args\n- Pass environment variables from config\n- Connect to stdio streams for MCP communication\n\n## Files to Modify\n- src/ALAN.Agent/Services/MCP/McpConfigurationService.cs\n\n## Implementation\n1. Add check for command-based servers (not HTTP)\n2. Create ProcessStartInfo with command, args, env\n3. Use StdioClientTransport from MCP SDK\n4. Create McpClient and list tools\n5. Store process reference for lifecycle management\n\n## Acceptance Criteria\n- [ ] Can spawn npx process with command/args\n- [ ] Environment variables are resolved and passed\n- [ ] Tools are discovered via stdio\n- [ ] Process is tracked for cleanup","status":"open","priority":1,"issue_type":"task","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:29:20.370807221+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:29:20.370807221+01:00","labels":["backend","feature","mcp"],"dependencies":[{"issue_id":"ALAN-sbd.1","depends_on_id":"ALAN-sbd","type":"parent-child","created_at":"2026-01-26T20:29:20.372637269+01:00","created_by":"jmservera"}]}
{"id":"ALAN-sbd.2","title":"Add MCP process lifecycle management","description":"Add process lifecycle management for spawned MCP server processes.\n\n## Technical Details\n- Track spawned MCP processes\n- Implement graceful shutdown on agent stop\n- Handle process crashes and restarts\n- Clean up zombie processes\n\n## Files to Modify\n- src/ALAN.Agent/Services/MCP/McpConfigurationService.cs\n- src/ALAN.Agent/Services/MCP/McpProcessManager.cs (new)\n\n## Implementation\n1. Create McpProcessManager service\n2. Track Process objects by server name\n3. Implement IDisposable/IAsyncDisposable for cleanup\n4. Add restart logic for crashed processes\n5. Register as hosted service for shutdown hook\n\n## Acceptance Criteria\n- [ ] Processes are tracked by name\n- [ ] Graceful shutdown kills all MCP processes\n- [ ] Crashed processes can be restarted\n- [ ] No zombie processes after agent shutdown","status":"open","priority":2,"issue_type":"task","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:29:34.419927532+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:29:34.419927532+01:00","labels":["backend","feature","mcp"],"dependencies":[{"issue_id":"ALAN-sbd.2","depends_on_id":"ALAN-sbd","type":"parent-child","created_at":"2026-01-26T20:29:34.421634584+01:00","created_by":"jmservera"}]}
{"id":"ALAN-sbd.3","title":"Add environment variable resolution for MCP config","description":"Improve environment variable resolution in MCP configuration.\n\n## Technical Details\n- Support ${VAR_NAME} syntax in env values\n- Support $VAR_NAME syntax (existing in pat field)\n- Handle missing env vars gracefully with warnings\n- Document required env vars for each server\n\n## Files to Modify\n- src/ALAN.Agent/Services/MCP/McpConfigurationService.cs\n\n## Implementation\n1. Create ResolveEnvironmentVariable helper method\n2. Apply to all env dictionary values\n3. Apply to pat field consistently\n4. Log warnings for missing required vars\n5. Support default values syntax: ${VAR:-default}\n\n## Acceptance Criteria\n- [ ] ${VAR} syntax works in env values\n- [ ] $VAR syntax works in pat field\n- [ ] Missing vars logged as warnings\n- [ ] Default value syntax supported","status":"open","priority":2,"issue_type":"task","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:29:43.670490158+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:29:43.670490158+01:00","labels":["backend","feature","mcp"],"dependencies":[{"issue_id":"ALAN-sbd.3","depends_on_id":"ALAN-sbd","type":"parent-child","created_at":"2026-01-26T20:29:43.67202661+01:00","created_by":"jmservera"}]}
{"id":"ALAN-sbd.4","title":"Configure GitHub MCP server via npx","description":"Add GitHub MCP server configuration using npx.\n\n## Server Details\n- Package: @modelcontextprotocol/server-github\n- Requires: GITHUB_PERSONAL_ACCESS_TOKEN env var\n\n## Configuration\n```yaml\nmcp:\n  servers:\n    github:\n      command: npx\n      args:\n        - -y\n        - \"@modelcontextprotocol/server-github\"\n      env:\n        GITHUB_PERSONAL_ACCESS_TOKEN: ${GITHUB_PERSONAL_ACCESS_TOKEN}\n```\n\n## Files to Modify\n- src/ALAN.Agent/mcp-config.yaml\n\n## Available Tools\n- list_repos, get_file_contents, search_code\n- list_issues, create_issue, update_issue\n- list_pull_requests, create_pull_request\n- commit_changes, push_branch\n\n## Acceptance Criteria\n- [ ] GitHub server configured in mcp-config.yaml\n- [ ] Agent can list repos via MCP tool\n- [ ] Agent can search code via MCP tool","status":"open","priority":2,"issue_type":"task","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:29:55.167746799+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:29:55.167746799+01:00","labels":["config","feature","mcp"],"dependencies":[{"issue_id":"ALAN-sbd.4","depends_on_id":"ALAN-sbd","type":"parent-child","created_at":"2026-01-26T20:29:55.169522108+01:00","created_by":"jmservera"}]}
{"id":"ALAN-sbd.5","title":"Configure filesystem MCP server via npx","description":"Add filesystem MCP server for local file access.\n\n## Server Details\n- Package: @modelcontextprotocol/server-filesystem\n- Allows agent to read/write local files\n\n## Configuration\n```yaml\nmcp:\n  servers:\n    filesystem:\n      command: npx\n      args:\n        - -y\n        - \"@modelcontextprotocol/server-filesystem\"\n        - \"/path/to/allowed/directory\"\n      env: {}\n```\n\n## Files to Modify\n- src/ALAN.Agent/mcp-config.yaml\n\n## Available Tools\n- read_file, write_file, list_directory\n- create_directory, delete_file, move_file\n\n## Security Considerations\n- Restrict to specific directories\n- Consider read-only mode option\n\n## Acceptance Criteria\n- [ ] Filesystem server configured in mcp-config.yaml\n- [ ] Agent can list directories via MCP tool\n- [ ] Agent can read files via MCP tool","status":"open","priority":2,"issue_type":"task","owner":"8036360+jmservera@users.noreply.github.com","created_at":"2026-01-26T20:30:10.252971588+01:00","created_by":"jmservera","updated_at":"2026-01-26T20:30:10.252971588+01:00","labels":["config","feature","mcp"],"dependencies":[{"issue_id":"ALAN-sbd.5","depends_on_id":"ALAN-sbd","type":"parent-child","created_at":"2026-01-26T20:30:10.2552177+01:00","created_by":"jmservera"}]}
